{
  "url": "https://workbench.cisecurity.org/sections/1051550/recommendations/1715875",
  "title": "Ensure Access Review is Set Up for External Users in Azure AD Privileged Identity Management",
  "ref": "1.3",
  "automated_scoring-recomendtation-data": "Manual",
  "description-recomendtation-data": "<p>This recommendation extends guest access review by utilizing the Azure AD Privileged Identity Management feature provided in Azure AD Premium P2.</p>\n<p>Azure AD is extended to include Azure AD B2B collaboration, allowing you to invite people from outside your organization to be guest users in your cloud account and sign in with their own work, school, or social identities. Guest users allow you to share your company's applications and services with users from any other organization, while maintaining control over your own corporate data.</p>\n<p>Work with external partners, large or small, even if they don't have Azure AD or an IT department. A simple invitation and redemption process lets partners use their own credentials to access your company's resources a a guest user.</p>",
  "rationale_statement-recomendtation-data": "<p>Guest users in the Azure AD are generally required for collaboration purposes in Office 365, and may also be required for Azure functions in enterprises with multiple Azure tenants. Guest users should be reviewed on a regular basis, at least annually. Guest users should not be granted administrative roles where possible.</p>\n<p>Guest users are typically added outside your employee on-boarding/off-boarding process and could potentially be overlooked indefinitely, leading to a potential vulnerability.</p>\n<p>Guest users should be reviewed on a monthly basis to ensure that inactive and unneeded accounts are removed.</p>",
  "impact_statement-recomendtation-data": "<p>Until you have a business need to provide guest access to any user, avoid creating guest users. If guest accounts are being used, they should be removed when no longer required.</p>",
  "audit_procedure-recomendtation-data": "<p><strong>From Azure Portal</strong></p>\n<ol>\n<li>\n<p>From the Azure Portal home page click the portal menu in the top left.</p>\n</li>\n<li>\n<p>Select <code>Azure Active Directory</code></p>\n</li>\n<li>\n<p>Select <code>Users</code> in the left column under the <code>Manage</code> heading.</p>\n</li>\n<li>\n<p>Next to the search box select the <code>filter</code> option.</p>\n</li>\n<li>\n<p>Search for and select <code>User Type</code></p>\n</li>\n<li>\n<p>In the third drop down <code>Value</code> select <code>Guest</code>.</p>\n</li>\n<li>\n<p>Review the guest users in your <code>Active Directory</code>.</p>\n</li>\n</ol>\n<p><strong>From Azure CLI</strong></p>\n<p>Run the following command:</p>\n<pre><code>az ad user list -Filter \"UserType eq 'Guest'\"\n</code></pre>\n<p><strong>From Powershell</strong></p>\n<p>Run the following command:</p>\n<pre><code>Get-AzureADUser -Filter \"UserType eq 'Guest'\"\n</code></pre>",
  "remediation_procedure-recomendtation-data": "<p><strong>From Azure Portal</strong></p>\n<ol>\n<li>\n<p>From the Azure Portal home page click the portal menu in the top left.</p>\n</li>\n<li>\n<p>Select <code>Azure Active Directory</code></p>\n</li>\n<li>\n<p>Select <code>Users</code> in the left column under the <code>Manage</code> heading.</p>\n</li>\n<li>\n<p>Next to the search box select the <code>filter</code> option.</p>\n</li>\n<li>\n<p>Search for and select <code>User Type</code></p>\n</li>\n<li>\n<p>In the third drop down <code>Value</code> select <code>Guest</code>.</p>\n</li>\n<li>\n<p>Review the guest users in your Active Directory.</p>\n</li>\n<li>\n<p>For those you wish to delete, select the checkbox on the left then the <code>Delete</code> option in the top row.</p>\n</li>\n</ol>\n<p><strong>From Azure CLI</strong></p>\n<p>With the information from the audit procedure, to remove a Guest user run the following command with their User Principal Value.</p>\n<pre><code>Remove-AzureADUser -ObjectId \"&lt;<a class=\"__cf_email__\" data-cfemail=\"451036203715372c2b262c3524290b242820052028242c29242121372036366b262a28\" href=\"/cdn-cgi/l/email-protection\">[email\xa0protected]</a>\"\n</code></pre>\n<p><strong>From Powershell</strong></p>\n<p>With the information from the audit procedure, to remove a Guest user run the following command with their User Principal Value.</p>\n<pre><code>Remove-AzureADUser -ObjectId \"&lt;<a class=\"__cf_email__\" data-cfemail=\"a8fddbcddaf8dac1c6cbc1d8c9c4e6c9c5cde8cdc5c9c1c4c9ccccdacddbdb86cbc7c5\" href=\"/cdn-cgi/l/email-protection\">[email\xa0protected]</a>&gt;\"\n</code></pre>",
  "default_value-recomendtation-data": "<p>By default no guest users are created.</p>",
  "artifact_equation-recomendtation-data": "",
  "mitre_mappings-recomendtation-data": "<h3>Mitre Mapping</h3>\n<table class=\"table table-hover\">\n<tr>\n<th>Technique / Subtechnique</th>\n</tr>\n<tr>\n<td>T1078.004</td>\n</tr>\n<tr>\n<th>Tactics</th>\n</tr>\n<tr>\n<td>TA0001</td>\n</tr>\n<tr>\n<th>Mitigations</th>\n</tr>\n<tr>\n<td>M1026</td>\n</tr>\n</table>",
  "references-recomendtation-data": "<p><p><a href=\"https://docs.microsoft.com/en-us/azure/active-directory/b2b/user-properties\">https://docs.microsoft.com/en-us/azure/active-directory/b2b/user-properties</a></p>\n</p>\n<p><p><a href=\"https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/add-users-azure-active-directory#delete-a-user\">https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/add-users-azure-active-directory#delete-a-user</a></p>\n</p>\n<p><p><a href=\"https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-privileged-access#pa-3-review-and-reconcile-user-access-regularly\">https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-privileged-access#pa-3-review-and-reconcile-user-access-regularly</a></p>\n</p>\n<p><p><a href=\"https://docs.microsoft.com/en-us/azure/active-directory/governance/manage-guest-access-with-access-reviews\">https://docs.microsoft.com/en-us/azure/active-directory/governance/manage-guest-access-with-access-reviews</a></p>\n</p>\n<p><p><a href=\"https://www.microsoft.com/en-us/security/business/identity-access-management/azure-ad-pricing\">https://www.microsoft.com/en-us/security/business/identity-access-management/azure-ad-pricing</a></p>\n</p>"
}
